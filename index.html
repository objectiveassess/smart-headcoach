<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì¡°ê¸°ì¶•êµ¬ 4ì¿¼í„° í¬ë©”ì´ì…˜ ìë™ ë°°ì •</title>
<style>
body {
  font-family: 'Noto Sans KR', sans-serif;
  background: #0b1622;
  color: #f0f6fc;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  margin: 30px auto;
  background: rgba(255,255,255,0.05);
  border-radius: 10px;
  padding: 20px;
  position: relative;
  top: 60px;
}
h1 {
  text-align: center;
  color: #00c896;
}
input, select, button {
  padding: 8px;
  border-radius: 6px;
  border: none;
  margin: 4px;
}
input, select {
  width: 100%;
}
button {
  background: #00c896;
  color: #0b1622;
  font-weight: 600;
  cursor: pointer;
}
button:hover {
  background: #00e6aa;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
  font-size: 14px;
}
th, td {
  padding: 8px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  text-align: left;
}
.quarter {
  margin-top: 25px;
  background: rgba(255,255,255,0.03);
  border-radius: 8px;
  padding: 10px;
}
.flex {
  display: flex;
  gap: 6px;
  align-items: center;
}

/* ìƒë‹¨ ë°°ë„ˆ */
#ad-banner {
  position: fixed;
  top: -60px;
  left: 0;
  width: 100%;
  background: #00c896;
  color: #0b1622;
  text-align: center;
  padding: 15px 0;
  font-weight: 600;
  z-index: 9999;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
  transition: top 0.5s ease;
}
#ad-close {
  cursor: pointer;
  margin-left: 15px;
  font-weight: bold;
}

/* ì¶œì „ ê·¸ë˜í”„ */
.bar {
  height: 16px;
  background: #00c896;
  border-radius: 4px;
  display: inline-block;
}
</style>
</head>
<body>

<!-- ìƒë‹¨ ë°°ë„ˆ -->
<div id="ad-banner">
  "It's okay though" - ë„ì‚¬ì»´í¼ë‹ˆ
  <span id="ad-close">âœ–</span>
</div>

<div class="container">
  <h1>âš½ ì¡°ê¸°ì¶•êµ¬ 4ì¿¼í„° ìë™ ë°°ì • (Diamond 4-4-2)</h1>
  <p>ì´ë¦„ê³¼ í¬ì§€ì…˜ì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ì¿¼í„°ë³„ í¬ë©”ì´ì…˜ì„ ìƒì„±í•©ë‹ˆë‹¤.<br>
  ğŸ§¤ GKëŠ” 4ì¿¼í„° ì „ë¶€ ê³ ì •, ë‚˜ë¨¸ì§€ëŠ” 3ì¿¼í„° ì´í•˜ë§Œ ë°°ì •ë©ë‹ˆë‹¤.<br>
  ğŸ“‹ ë¼ì¸ì—…: GK â†’ ìˆ˜ë¹„4 â†’ ë¯¸ë“œ4 â†’ ê³µê²©2 ìˆœ (Diamond 4-4-2)</p>

  <div id="player-inputs"></div>
  <button onclick="addPlayer()">+ ì„ ìˆ˜ ì¶”ê°€</button>
  <button onclick="refreshAndGenerate()">âœ… í¬ë©”ì´ì…˜ ìƒì„±</button>

  <div id="result"></div>
</div>

<script>
let players = [];

// ë°°ë„ˆ ì• ë‹ˆë©”ì´ì…˜
window.onload = function() {
  const banner = document.getElementById('ad-banner');
  setTimeout(() => { banner.style.top = '0'; }, 300);
}
document.getElementById('ad-close').addEventListener('click', function(){
  const banner = document.getElementById('ad-banner');
  banner.style.top = '-60px';
  document.querySelector('.container').style.top = '0';
});

// ì„ ìˆ˜ ì¶”ê°€
function addPlayer() {
  const div = document.createElement('div');
  div.className = 'flex';
  div.innerHTML = `
    <input type="text" placeholder="ì´ë¦„" class="name">
    <select class="pos1">
      <option value="">1ìˆœìœ„ í¬ì§€ì…˜</option>
      <option>GK</option><option>CB</option><option>RB</option><option>LB</option>
      <option>CDM</option><option>CM</option><option>CAM</option>
      <option>LM</option><option>RM</option>
      <option>ST</option><option>RW</option><option>LW</option>
    </select>
    <select class="pos2">
      <option value="">2ìˆœìœ„ í¬ì§€ì…˜</option>
      <option>GK</option><option>CB</option><option>RB</option><option>LB</option>
      <option>CDM</option><option>CM</option><option>CAM</option>
      <option>LM</option><option>RM</option>
      <option>ST</option><option>RW</option><option>LW</option>
    </select>
  `;
  document.getElementById('player-inputs').appendChild(div);
}

// ìƒˆë¡œê³ ì¹¨ í›„ ìë™ ìƒì„±
function refreshAndGenerate() {
  localStorage.setItem('playersData', JSON.stringify(getPlayerData()));
  location.reload();
}

// ìƒˆë¡œê³ ì¹¨ í›„ ë°ì´í„° ìœ ì§€
window.addEventListener('load', () => {
  const saved = localStorage.getItem('playersData');
  if (saved) {
    const list = JSON.parse(saved);
    localStorage.removeItem('playersData');
    list.forEach(p => addPlayer());
    const rows = document.querySelectorAll('#player-inputs .flex');
    list.forEach((p, i) => {
      rows[i].querySelector('.name').value = p.name;
      rows[i].querySelector('.pos1').value = p.pos1;
      rows[i].querySelector('.pos2').value = p.pos2;
    });
    generateSchedule();
  }
});

// ì„ ìˆ˜ ë°ì´í„° ì½ê¸°
function getPlayerData() {
  const data = [];
  document.querySelectorAll('#player-inputs .flex').forEach(r => {
    const name = r.querySelector('.name').value.trim();
    const pos1 = r.querySelector('.pos1').value;
    const pos2 = r.querySelector('.pos2').value;
    if (name) data.push({name, pos1, pos2});
  });
  return data;
}

// í¬ë©”ì´ì…˜ ìƒì„±
function generateSchedule() {
  players = getPlayerData().map(p => ({...p, count:0}));

  if (players.length < 11) {
    alert('âš ï¸ ìµœì†Œ 11ëª… ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”!');
    return;
  }

  const gk = players.find(p => p.pos1==='GK' || p.pos2==='GK');
  if (!gk) {
    alert('âš ï¸ ê³¨í‚¤í¼(GK)ê°€ ë°˜ë“œì‹œ 1ëª… ì´ìƒ í•„ìš”í•©ë‹ˆë‹¤!');
    return;
  }

  gk.count = 4;
  const GK = gk.name;
  const fieldPlayers = players.filter(p => p.name !== GK);

  // í¬ì§€ì…˜ ê·¸ë£¹
  const groups = {
    GK: [gk],
    LB: fieldPlayers.filter(p=>p.pos1==='LB'||p.pos2==='LB'),
    RB: fieldPlayers.filter(p=>p.pos1==='RB'||p.pos2==='RB'),
    CB: fieldPlayers.filter(p=>p.pos1==='CB'||p.pos2==='CB'),
    CDM: fieldPlayers.filter(p=>p.pos1==='CDM'||p.pos2==='CDM'),
    LM: fieldPlayers.filter(p=>p.pos1==='LM'||p.pos2==='LM'),
    RM: fieldPlayers.filter(p=>p.pos1==='RM'||p.pos2==='RM'),
    CAM: fieldPlayers.filter(p=>p.pos1==='CAM'||p.pos2==='CAM'),
    ST: fieldPlayers.filter(p=>['ST','RW','LW'].includes(p.pos1)||['ST','RW','LW'].includes(p.pos2)),
  };

  // ë‹¤ì´ì•„ëª¬ë“œ 4-4-2
  const order = ['GK','LB','CB','CB','RB','CDM','LM','CAM','RM','ST','ST'];
  const quarters=[[],[],[],[]];

  for(let q=0;q<4;q++){
    const lineup=[];
    order.forEach(pos=>{
      if(pos==='GK') lineup.push({pos:'GK', name:GK});
      else {
        const p = pick(groups[pos],1)[0] || empty(pos);
        lineup.push(p);
      }
    });
    quarters[q]=lineup;
  }

  // ì¶œë ¥
  let html='';
  quarters.forEach((qline,i)=>{
    html+=`<div class="quarter"><h3>ğŸ•’ ${i+1}ì¿¼í„° (25ë¶„)</h3><table><tr><th>í¬ì§€ì…˜</th><th>ì´ë¦„</th></tr>`;
    qline.forEach(p=>{ html+=`<tr><td>${p.pos}</td><td>${p.name}</td></tr>` });
    html+='</table></div>';
  });

  // ì¶œì „ ìš”ì•½ + ê·¸ë˜í”„
  html+='<h3>âš–ï¸ ì¶œì „ ì¿¼í„° ìš”ì•½</h3><table><tr><th>ì´ë¦„</th><th>ì¶œì „ ìˆ˜</th><th>ê·¸ë˜í”„</th></tr>';
  players.forEach(p=>{
    const width = (p.count/4)*100;
    html+=`<tr><td>${p.name}</td><td>${p.count}</td><td><div class="bar" style="width:${width}%;"></div></td></tr>`;
  });
  html+='</table>';

  document.getElementById('result').innerHTML=html;
}

// ì¶œì „ ì ì€ ìˆœìœ¼ë¡œ ì„ íƒ
function pick(pool,n){
  if(!pool||pool.length===0) return [];
  const sorted = [...pool].sort((a,b)=>a.count-b.count);
  const chosen=[];
  for(const p of sorted){
    if(chosen.length>=n) break;
    if(p.count<3){
      chosen.push({pos:p.pos1 || p.pos2 || 'ê¸°íƒ€', name:p.name || 'â€”'});
      p.count++;
    }
  }
  return chosen;
}

function empty(pos){ return {pos:pos, name:'â€”'}; }
</script>
</body>
</html>
